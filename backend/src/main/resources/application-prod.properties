# Production Profile Configuration
# This profile is used for production deployment
# 
# SECURITY: All sensitive values must be provided via environment variables.
# Never commit credentials to version control.
# See .env.example for required environment variables.

# MongoDB Configuration - Production (MongoDB Atlas)
# REQUIRED: Set MONGODB_URI environment variable
# Connection string should include: retryWrites=true&w=majority&ssl=true
# Example: mongodb+srv://username:password@cluster.mongodb.net/database?retryWrites=true&w=majority&ssl=true
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.database=${MONGODB_DATABASE:finance_tracker}

# MongoDB Connection Pool Configuration
# Increase connection timeout for network latency (default: 30s)
spring.data.mongodb.option.connect-timeout-ms=60000
spring.data.mongodb.option.socket-timeout-ms=60000
spring.data.mongodb.option.server-selection-timeout-ms=30000

# Connection Pool Settings
# Minimum connections in pool
spring.data.mongodb.option.min-pool-size=10
# Maximum connections in pool
spring.data.mongodb.option.max-pool-size=100
# Maximum wait time for a connection from the pool
spring.data.mongodb.option.max-wait-time-ms=30000
# Maximum idle time for a connection
spring.data.mongodb.option.max-connection-idle-time-ms=600000

# SSL/TLS Configuration (required for MongoDB Atlas)
# SSL is enabled by default for mongodb+srv:// connections
# Additional SSL options if needed
spring.data.mongodb.option.ssl-enabled=true
spring.data.mongodb.option.ssl-invalid-host-name-allowed=false

# Server Configuration - Production
# Render sets PORT environment variable, but we use SERVER_PORT for Spring Boot
# Fallback to PORT if SERVER_PORT is not set (for Render compatibility)
server.port=${SERVER_PORT:${PORT:8080}}

# Logging Configuration - Less verbose for production
logging.level.root=WARN
logging.level.com.finance.tracker=INFO
logging.level.org.springframework.web=WARN
logging.level.org.springframework.data.mongodb=WARN

# Mongock Configuration
# Run migrations on startup in production
mongock.runner.enabled=true

# Note: Mongock uses the MongoDB connection configured above
# Connection retry and timeout are handled by MongoDB driver settings
# If Mongock fails to connect, check MongoDB connection configuration above

# Spring Boot DevTools - Disabled in production
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false

# Actuator Configuration - Production
# Only expose essential endpoints for security
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

