# Production Profile Configuration
# This profile is used for production deployment
# 
# SECURITY: All sensitive values must be provided via environment variables.
# Never commit credentials to version control.
# 
# Required Environment Variables:
# - MONGODB_URI (required) - MongoDB connection string
# - FIREBASE_CREDENTIALS_BASE64 (required) - Base64 encoded Firebase service account JSON
# - WEB_CLIENT_ID (required) - Google OAuth client ID
# 
# Optional Environment Variables (with defaults):
# - MONGODB_DATABASE (default: finance_tracker)
# - SERVER_PORT or PORT (default: 8080)
# - MONGODB_MIN_POOL_SIZE (default: 10)
# - MONGODB_MAX_POOL_SIZE (default: 100)
# - LOG_LEVEL_ROOT (default: WARN)
# - LOG_LEVEL_APP (default: INFO)
# - ACTUATOR_ENDPOINTS (default: health,info,metrics,prometheus)

# MongoDB Configuration - Production (MongoDB Atlas)
# REQUIRED: Set MONGODB_URI environment variable
# Connection string should include: retryWrites=true&w=majority&ssl=true
# Example: mongodb+srv://username:password@cluster.mongodb.net/database?retryWrites=true&w=majority&ssl=true
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.database=${MONGODB_DATABASE:finance_tracker}

# MongoDB Connection Pool Configuration
# All values can be overridden with environment variables
# Increase connection timeout for network latency (default: 30s)
spring.data.mongodb.option.connect-timeout-ms=${MONGODB_CONNECT_TIMEOUT_MS:60000}
spring.data.mongodb.option.socket-timeout-ms=${MONGODB_SOCKET_TIMEOUT_MS:60000}
spring.data.mongodb.option.server-selection-timeout-ms=${MONGODB_SERVER_SELECTION_TIMEOUT_MS:30000}

# Connection Pool Settings
# Minimum connections in pool
spring.data.mongodb.option.min-pool-size=${MONGODB_MIN_POOL_SIZE:10}
# Maximum connections in pool
spring.data.mongodb.option.max-pool-size=${MONGODB_MAX_POOL_SIZE:100}
# Maximum wait time for a connection from the pool
spring.data.mongodb.option.max-wait-time-ms=${MONGODB_MAX_WAIT_TIME_MS:30000}
# Maximum idle time for a connection
spring.data.mongodb.option.max-connection-idle-time-ms=${MONGODB_MAX_CONNECTION_IDLE_TIME_MS:600000}

# SSL/TLS Configuration (required for MongoDB Atlas)
# SSL is enabled by default for mongodb+srv:// connections
# Can be disabled with MONGODB_SSL_ENABLED=false (not recommended for production)
spring.data.mongodb.option.ssl-enabled=${MONGODB_SSL_ENABLED:true}
spring.data.mongodb.option.ssl-invalid-host-name-allowed=${MONGODB_SSL_INVALID_HOST_NAME_ALLOWED:false}

# Server Configuration - Production
# Render sets PORT environment variable, but we use SERVER_PORT for Spring Boot
# Fallback to PORT if SERVER_PORT is not set (for Render compatibility)
server.port=${SERVER_PORT:${PORT:8080}}

# Logging Configuration - Less verbose for production
# Can be customized with environment variables for different log levels
logging.level.root=${LOG_LEVEL_ROOT:WARN}
logging.level.com.finance.tracker=${LOG_LEVEL_APP:INFO}
logging.level.org.springframework.web=${LOG_LEVEL_WEB:WARN}
logging.level.org.springframework.data.mongodb=${LOG_LEVEL_MONGODB:WARN}

# Mongock Configuration
# Run migrations on startup in production
# Can be disabled with MONGOCK_ENABLED=false (not recommended)
mongock.runner.enabled=${MONGOCK_ENABLED:true}

# Note: Mongock uses the MongoDB connection configured above
# Connection retry and timeout are handled by MongoDB driver settings
# If Mongock fails to connect, check MongoDB connection configuration above

# Spring Boot DevTools - Disabled in production
# Should never be enabled in production
spring.devtools.restart.enabled=${DEVTOOLS_ENABLED:false}
spring.devtools.livereload.enabled=${DEVTOOLS_LIVERELOAD_ENABLED:false}

# Actuator Configuration - Production
# Only expose essential endpoints for security
# Can be customized with ACTUATOR_ENDPOINTS environment variable (comma-separated)
# Default: health,info,metrics,prometheus
management.endpoints.web.exposure.include=${ACTUATOR_ENDPOINTS:health,info,metrics,prometheus}
management.endpoint.health.show-details=${ACTUATOR_HEALTH_DETAILS:when-authorized}
management.metrics.export.prometheus.enabled=${ACTUATOR_PROMETHEUS_ENABLED:true}

